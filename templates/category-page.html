<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/CollectionPage">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{CATEGORY_NAME}} Games - Free Online {{CATEGORY_NAME}} Games | MiniGamesHub.co</title>
    <meta name="description" content="Play the best free {{CATEGORY_NAME}} games online! Discover {{GAME_COUNT}} amazing {{CATEGORY_NAME}} games. {{CATEGORY_DESCRIPTION}} No downloads required!">
    <meta name="keywords" content="{{CATEGORY_NAME}} games, free {{CATEGORY_NAME}} games, online {{CATEGORY_NAME}} games, browser {{CATEGORY_NAME}} games">
    <meta name="author" content="MiniGamesHub.co">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://minigameshub.co/collections/category/{{CATEGORY_SLUG}}">
    <meta property="og:title" content="{{CATEGORY_NAME}} Games - Free Online {{CATEGORY_NAME}} Games">
    <meta property="og:description" content="Play the best free {{CATEGORY_NAME}} games online! Discover {{GAME_COUNT}} amazing {{CATEGORY_NAME}} games.">
    <meta property="og:image" content="https://minigameshub.co/assets/images/categories/{{CATEGORY_SLUG}}.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://minigameshub.co/collections/category/{{CATEGORY_SLUG}}">
    <meta property="twitter:title" content="{{CATEGORY_NAME}} Games - Free Online {{CATEGORY_NAME}} Games">
    <meta property="twitter:description" content="Play the best free {{CATEGORY_NAME}} games online! Discover {{GAME_COUNT}} amazing {{CATEGORY_NAME}} games.">
    <meta property="twitter:image" content="https://minigameshub.co/assets/images/categories/{{CATEGORY_SLUG}}.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://minigameshub.co/collections/category/{{CATEGORY_SLUG}}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Structured Data - Collection Page -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "{{CATEGORY_NAME}} Games",
        "description": "{{CATEGORY_DESCRIPTION}}",
        "url": "https://minigameshub.co/collections/category/{{CATEGORY_SLUG}}",
        "mainEntity": {
            "@type": "ItemList",
            "name": "{{CATEGORY_NAME}} Games",
            "description": "Collection of free online {{CATEGORY_NAME}} games",
            "numberOfItems": {{GAME_COUNT}},
            "itemListElement": [
                {{GAMES_STRUCTURED_DATA}}
            ]
        },
        "breadcrumb": {
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Home",
                    "item": "https://minigameshub.co"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "{{CATEGORY_NAME}} Games",
                    "item": "https://minigameshub.co/collections/category/{{CATEGORY_SLUG}}"
                }
            ]
        },
        "publisher": {
            "@type": "Organization",
            "name": "MiniGamesHub.co",
            "url": "https://minigameshub.co"
        }
    }
    </script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav container">
            <div class="nav-brand">
                <a href="/" class="logo">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="40" height="40" rx="12" fill="url(#gradient)"/>
                        <path d="M12 20L18 26L28 16" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <defs>
                            <linearGradient id="gradient" x1="0" y1="0" x2="40" y2="40">
                                <stop offset="0%" stop-color="#007AFF"/>
                                <stop offset="100%" stop-color="#5856D6"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <span class="logo-text">MiniGamesHub</span>
                </a>
            </div>
            
            <div class="nav-menu" id="nav-menu">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="/" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle active">Categories</a>
                        <ul class="dropdown-menu">
                            {{CATEGORY_NAVIGATION_LINKS}}
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a href="/collections/featured" class="nav-link" data-local-href="/collection.html?collection=featured">Featured</a>
                    </li>
                    <li class="nav-item">
                        <a href="/collections/popular" class="nav-link" data-local-href="/collection.html?collection=popular">Popular</a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-actions">
                <button class="search-toggle" id="search-toggle" aria-label="Toggle search">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="21 21L16.65 16.65"></path>
                    </svg>
                </button>
                
                <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation">
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                </button>
            </div>
        </nav>
        
        <!-- Search Bar -->
        <div class="search-container" id="search-container">
            <div class="search-box container">
                <input type="text" id="search-input" placeholder="Search {{CATEGORY_NAME}} games..." autocomplete="off">
                <button class="search-btn" id="search-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="21 21L16.65 16.65"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Breadcrumbs -->
    <nav class="breadcrumbs">
        <div class="container">
            <ol class="breadcrumb-list" itemscope itemtype="https://schema.org/BreadcrumbList">
                <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <a itemprop="item" href="/">
                        <span itemprop="name">Home</span>
                    </a>
                    <meta itemprop="position" content="1">
                </li>
                <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem" class="active">
                    <span itemprop="name">{{CATEGORY_NAME}} Games</span>
                    <meta itemprop="position" content="2">
                </li>
            </ol>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <!-- Category Hero Section -->
        <section class="category-hero">
            <div class="container">
                <div class="category-hero-content">
                    <div class="category-icon-large">
                        {{CATEGORY_ICON}}
                    </div>
                    <div class="category-info">
                        <h1 class="category-title">{{CATEGORY_NAME}} Games</h1>
                        <p class="category-description">{{CATEGORY_DESCRIPTION_FULL}}</p>
                        <div class="category-stats">
                            <span class="stat">{{GAME_COUNT}} Games</span>
                            <span class="stat">{{TOTAL_PLAYS}} Total Plays</span>
                            <span class="stat">{{AVERAGE_RATING}}/5 Average Rating</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Featured Games in Category -->
        <section class="featured-category-games section" style="{{FEATURED_GAMES_DISPLAY}}">
            <div class="container">
                <h2 class="section-title">Featured {{CATEGORY_NAME}} Games</h2>
                <div class="games-grid" id="featured-games">
                    {{FEATURED_GAMES_HTML}}
                </div>
            </div>
        </section>

        <!-- Games Filter and Sort -->
        <section class="games-controls section">
            <div class="container">
                <div class="controls-bar">
                    <div class="filter-controls">
                        <label for="sort-select">Sort by:</label>
                        <select id="sort-select" class="sort-select">
                            <option value="featured">Featured</option>
                            <option value="popular">Most Popular</option>
                            <option value="newest">Newest</option>
                            <option value="rating">Highest Rated</option>
                            <option value="name">A-Z</option>
                        </select>
                    </div>
                    
                    <div class="view-controls">
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="grid" aria-label="Grid view">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="3" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="14" width="7" height="7"></rect>
                                    <rect x="3" y="14" width="7" height="7"></rect>
                                </svg>
                            </button>
                            <button class="view-btn" data-view="list" aria-label="List view">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <line x1="8" y1="6" x2="21" y2="6"></line>
                                    <line x1="8" y1="12" x2="21" y2="12"></line>
                                    <line x1="8" y1="18" x2="21" y2="18"></line>
                                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                        
                        <span class="results-count">{{GAME_COUNT}} games found</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- All Games in Category -->
        <section class="category-games section">
            <div class="container">
                <h2 class="section-title">All {{CATEGORY_NAME}} Games</h2>
                <div class="games-grid" id="games-grid">
                    {{ALL_GAMES_HTML}}
                </div>
                
                <div class="load-more-container" style="{{LOAD_MORE_DISPLAY}}">
                    <button class="load-more-btn" id="load-more-btn">
                        Load More {{CATEGORY_NAME}} Games
                    </button>
                </div>
            </div>
        </section>

        <!-- Related Categories -->
        <section class="related-categories section">
            <div class="container">
                <h2 class="section-title">Explore Other Categories</h2>
                <div class="categories-grid">
                    {{RELATED_CATEGORIES_HTML}}
                </div>
            </div>
        </section>

        <!-- Category FAQ -->
        <section class="category-faq section" style="{{FAQ_DISPLAY}}">
            <div class="container">
                <h2 class="section-title">Frequently Asked Questions</h2>
                <div class="faq-content">
                    <div class="faq-item">
                        <h3>What are {{CATEGORY_NAME}} games?</h3>
                        <p>{{FAQ_WHAT_ARE}}</p>
                    </div>
                    
                    <div class="faq-item">
                        <h3>Are these {{CATEGORY_NAME}} games free to play?</h3>
                        <p>Yes! All {{CATEGORY_NAME}} games on MiniGamesHub are completely free to play. You don't need to download anything or sign up - just click and play instantly in your web browser.</p>
                    </div>
                    
                    <div class="faq-item">
                        <h3>Can I play {{CATEGORY_NAME}} games on mobile?</h3>
                        <p>Many of our {{CATEGORY_NAME}} games are mobile-friendly and work great on smartphones and tablets. Look for the mobile-friendly badge on each game.</p>
                    </div>
                    
                    <div class="faq-item">
                        <h3>How often do you add new {{CATEGORY_NAME}} games?</h3>
                        <p>We regularly add new {{CATEGORY_NAME}} games to keep our collection fresh and exciting. Check back often to discover the latest additions!</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-brand">
                        <a href="/" class="footer-logo">
                            <svg width="32" height="32" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect width="40" height="40" rx="12" fill="url(#footerGradient)"/>
                                <path d="M12 20L18 26L28 16" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                <defs>
                                    <linearGradient id="footerGradient" x1="0" y1="0" x2="40" y2="40">
                                        <stop offset="0%" stop-color="#007AFF"/>
                                        <stop offset="100%" stop-color="#5856D6"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                            <span>MiniGamesHub</span>
                        </a>
                        <p class="footer-description">
                            Your ultimate destination for free online mini games. 
                            Play thousands of games across all genres!
                        </p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Game Categories</h3>
                    <ul class="footer-links">
                        {{FOOTER_CATEGORY_LINKS}}
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="/collections/featured" data-local-href="/collection.html?collection=featured">Featured Games</a></li>
                        <li><a href="/collections/new" data-local-href="/collection.html?collection=new">New Games</a></li>
                        <li><a href="/collections/popular" data-local-href="/collection.html?collection=popular">Popular Games</a></li>
                        <li><a href="/random">Random Game</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">About</h3>
                    <ul class="footer-links">
                        <li><a href="/privacy-policy">Privacy Policy</a></li>
                        <li><a href="/terms-of-service">Terms of Service</a></li>
                        <li><a href="/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 MiniGamesHub.co. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Category data
        const categoryData = {
            id: {{CATEGORY_ID}},
            name: "{{CATEGORY_NAME}}",
            slug: "{{CATEGORY_SLUG}}",
            gameCount: {{GAME_COUNT}}
        };
        
        // Load more functionality
        let currentPage = 1;
        const gamesPerPage = 12;
        
        document.getElementById('load-more-btn')?.addEventListener('click', function() {
            fetch(`/api/categories/${categoryData.slug}/games?page=${currentPage + 1}&limit=${gamesPerPage}`)
                .then(response => response.json())
                .then(games => {
                    if (games.length > 0) {
                        const gamesGrid = document.getElementById('games-grid');
                        games.forEach(game => {
                            gamesGrid.insertAdjacentHTML('beforeend', generateGameCard(game));
                        });
                        currentPage++;
                        
                        // Hide button if no more games
                        if (games.length < gamesPerPage) {
                            this.style.display = 'none';
                        }
                    } else {
                        this.style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error('Error loading more games:', error);
                    this.textContent = 'Error loading games';
                });
        });
        
        // Sort functionality
        document.getElementById('sort-select')?.addEventListener('change', function() {
            const sortBy = this.value;
            const gamesGrid = document.getElementById('games-grid');
            
            // Show loading state
            gamesGrid.innerHTML = '<div class="loading">Loading games...</div>';
            
            fetch(`/api/categories/${categoryData.slug}/games?sort=${sortBy}&limit=${gamesPerPage}`)
                .then(response => response.json())
                .then(games => {
                    gamesGrid.innerHTML = '';
                    games.forEach(game => {
                        gamesGrid.insertAdjacentHTML('beforeend', generateGameCard(game));
                    });
                    currentPage = 1;
                    
                    // Show/hide load more button
                    const loadMoreBtn = document.getElementById('load-more-btn');
                    if (loadMoreBtn) {
                        loadMoreBtn.style.display = games.length === gamesPerPage ? 'block' : 'none';
                    }
                })
                .catch(error => {
                    console.error('Error sorting games:', error);
                    gamesGrid.innerHTML = '<div class="error">Error loading games</div>';
                });
        });
        
        // View toggle
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const view = this.dataset.view;
                const gamesGrid = document.getElementById('games-grid');
                gamesGrid.className = `games-grid view-${view}`;
            });
        });
        
        // Game card generation function
        function generateGameCard(game) {
            return `
                <div class="game-card" data-game-id="${game.id}">
                    <div class="game-image">
                        <img src="${game.image}" alt="${game.name}" loading="lazy">
                        ${game.featured ? '<div class="game-badge">Featured</div>' : ''}
                        <button class="game-favorite" data-game-id="${game.id}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="game-info">
                        <h3 class="game-title">${game.name}</h3>
                        <p class="game-description">${game.description.substring(0, 100)}...</p>
                        <div class="game-meta">
                            <div class="game-rating">
                                <div class="stars">${generateStars(game.rating)}</div>
                                <span class="plays">${game.plays} plays</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Generate star rating
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let html = '';
            
            for (let i = 0; i < fullStars; i++) {
                html += '';
            }
            if (hasHalfStar) {
                html += '';
            }
            for (let i = fullStars + (hasHalfStar ? 1 : 0); i < 5; i++) {
                html += '';
            }
            
            return html;
        }
        
        // Search functionality
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        
        function performSearch() {
            const query = searchInput.value.trim();
            if (query) {
                window.location.href = `/search?q=${encodeURIComponent(query)}&category=${categoryData.id}`;
            }
        }
        
        searchBtn?.addEventListener('click', performSearch);
        searchInput?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
        
        // Game card click handlers
        document.addEventListener('click', function(e) {
            const gameCard = e.target.closest('.game-card');
            if (gameCard && !e.target.closest('.game-favorite')) {
                const gameId = gameCard.dataset.gameId;
                // Navigate to game page or open modal
                window.location.href = `/games/${gameId}`;
            }
            
            // Favorite button handler
            const favoriteBtn = e.target.closest('.game-favorite');
            if (favoriteBtn) {
                e.stopPropagation();
                favoriteBtn.classList.toggle('active');
                // Handle favorite logic here
            }
        });
    </script>
    
    <script src="/assets/js/localFallback.js"></script>
    <script src="/assets/js/gameData.js"></script>
    <script src="/assets/js/gameManager.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
        
        // Track category page view
        gtag('event', 'page_view', {
            'page_title': '{{CATEGORY_NAME}} Games',
            'page_location': window.location.href,
            'category': '{{CATEGORY_NAME}}'
        });
    </script>
</body>
</html>
